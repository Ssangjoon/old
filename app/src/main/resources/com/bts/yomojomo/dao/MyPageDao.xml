<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.bts.yomojomo.dao.MyPageDao">
  
  <resultMap type="MyPage" id="MyPageMap">
    <id column="memb_no" property="no"/>
    <result column="membername" property="name"/>
    <result column="email" property="email"/>
    <result column="tel" property="tel"/>
    <result column="post_no" property="postNo"/>
    <result column="roadname_addr" property="roadNameAddr"/>
    <result column="base_addr" property="baseAddr"/>
    <result column="addr" property="addr"/>
    

    
    <association property="activeLocal" javaType="ActiveLocal">
      <id column="act_local_no" property="no"/>
      <result column="name_si" property="nameSi"/>
      <result column="name_gu" property="nameGu"/>
    </association>
    

    
    <collection property="purpose" ofType="Purpose">
       <id column="pups_no" property="no"/>
       <result column="name" property="purposeName"/>
    </collection>
  </resultMap>
  
  <select id="findAll" resultMap="MyPageMap">
   <!-- select * from gms_memb;  -->      
  </select>

  <select id="findByMemberNo" resultMap="MyPageMap">      
    select
      m.memb_no,
      a.act_local_no,
      p.pups_no,
      m.membername,
      m.email,
      m.tel,
      m.post_no,
      m.roadname_addr,
      m.base_addr,
      m.addr,
      a.name_si,
      a.name_gu,
      p.name
    from
      gms_memb m
      inner join gms_final_activelocal fa on m.memb_no = fa.memb_no
      inner join gms_activelocal a on fa.act_local_no = a.act_local_no
      inner join gms_final_purpose fp on m.memb_no = fp.memb_no
      inner join gms_purpose p on fp.pups_no = p.pups_no
    where
      m.memb_no=#{no}
      
  </select>


</mapper>